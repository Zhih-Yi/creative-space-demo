(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15e64c30"],{b331:function(e,t,a){"use strict";a.r(t);a("b0c0");var c=a("7a23"),n={class:"container"},r={class:"row"},i=Object(c["i"])("div",{class:"col-12 py-5 text-center"},[Object(c["i"])("h1",null,"訂單管理")],-1),l={class:"col-12"},o={class:"table-responsive"},s={key:0,class:"table"},d=Object(c["i"])("thead",null,[Object(c["i"])("tr",null,[Object(c["i"])("th",null,"編號"),Object(c["i"])("th",null,"建立時間"),Object(c["i"])("th",null,"總金額"),Object(c["i"])("th",null,"客戶姓名"),Object(c["i"])("th",null,"是否付款"),Object(c["i"])("th",null,"編輯")])],-1),u={key:0,class:"text-success"},b={key:1},m={class:"col-12"};function O(e,t,a,O,p,j){var f=Object(c["D"])("BackPagination"),h=Object(c["D"])("MainModal"),g=Object(c["D"])("DeleteModal");return Object(c["w"])(),Object(c["e"])("div",n,[Object(c["i"])("div",r,[i,Object(c["i"])("div",l,[Object(c["i"])("div",o,[p.orders.length>0?(Object(c["w"])(),Object(c["e"])("table",s,[d,Object(c["i"])("tbody",null,[(Object(c["w"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(p.orders,(function(t){return Object(c["w"])(),Object(c["e"])("tr",{key:t.id},[Object(c["i"])("td",null,Object(c["H"])(t.id),1),Object(c["i"])("td",null,Object(c["H"])(e.$filters.date(t.create_at)),1),Object(c["i"])("td",null,Object(c["H"])(t.total),1),Object(c["i"])("td",null,Object(c["H"])(t.user.name),1),Object(c["i"])("td",null,[t.is_paid?(Object(c["w"])(),Object(c["e"])("span",u,"已付款")):Object(c["f"])("",!0),t.is_paid?Object(c["f"])("",!0):(Object(c["w"])(),Object(c["e"])("span",b,"未付款"))]),Object(c["i"])("td",null,[Object(c["i"])("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:function(e){return j.openModal(t)}}," 修改 ",8,["onClick"]),Object(c["i"])("button",{type:"button",class:"btn btn-outline-dark",onClick:function(e){return j.openDeleteModal(t)}}," 刪除 ",8,["onClick"])])])})),128))])])):Object(c["f"])("",!0)])]),Object(c["i"])("div",m,[Object(c["i"])(f,{pageItem:p.pageItem,onUpdatePage:j.getOrders},null,8,["pageItem","onUpdatePage"])])]),Object(c["i"])(h,{ref:"modalMain",currentItem:p.currentOrder,onUpdateOrder:j.updateOrder},{title:Object(c["Q"])((function(){return[Object(c["h"])(Object(c["H"])(p.modalTitle),1)]})),_:1},8,["currentItem","onUpdateOrder"]),Object(c["i"])(g,{ref:"modalDelete",currentItem:p.currentOrder,onDeleteItem:j.deleteOrder},{title:Object(c["Q"])((function(){return[Object(c["h"])(Object(c["H"])(p.modalTitle),1)]})),_:1},8,["currentItem","onDeleteItem"])])}var p=a("5530"),j=(a("99af"),a("a15b"),a("d58b")),f={class:"modal fade",ref:"modal",id:"OrderModal",tabindex:"-1","aria-labelledby":"OrderModalLabel","aria-hidden":"true"},h={class:"modal-dialog modal-fullscreen"},g={class:"modal-content"},v={class:"modal-header bg-primary text-white"},y={class:"modal-title",id:"OrderModalLabel"},k=Object(c["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),M={class:"modal-body"},_={class:"row"},w={class:"mb-3 col-md-6"},I=Object(c["i"])("label",{class:"form-label"},"訂單編號",-1),x={class:"h5"},C={class:"mb-3 col-md-6"},U=Object(c["i"])("label",{for:"create_at",class:"form-label"},"建立時間",-1),P={class:"h5"},V={class:"mb-3 col-md-6"},$=Object(c["i"])("label",{for:"is_paid",class:"form-label"},"*付款狀態",-1),D=Object(c["i"])("option",{value:"true"},"已付款",-1),S=Object(c["i"])("option",{value:"false"},"未付款",-1),H={class:"mb-3 col-md-6"},R=Object(c["i"])("label",{for:"total",class:"form-label"},"*總金額",-1),q={class:"h5"},N={class:"my-3 col-12"},B=Object(c["i"])("label",{class:"form-label"},"*訂購商品",-1),J={class:"bg-light row p-md-3"},Q={class:"col-md-5 col-sm-6 mb-2 col-12"},T={class:"col-md-3 col-sm-3 mb-2 col-6"},L={class:"input-number-group input-group"},z=Object(c["i"])("i",{class:"bi bi-dash-lg"},null,-1),A=Object(c["i"])("i",{class:"bi bi-plus-lg"},null,-1),E={class:"col-md-4 col-sm-3 mb-2 col-6"},F=Object(c["i"])("div",{class:"col-12"},[Object(c["i"])("label",{class:"form-label"},"訂購者資料")],-1),G={class:"mb-3 col-md-6"},K=Object(c["i"])("label",{for:"username",class:"form-label"},"*姓名:",-1),W={class:"mb-3 col-md-6"},X=Object(c["i"])("label",{for:"tel",class:"form-label"},"*電話:",-1),Y={class:"mb-3 col-md-6"},Z=Object(c["i"])("label",{for:"email",class:"form-label"},"*email:",-1),ee={class:"mb-3 col-6"},te=Object(c["i"])("label",{for:"address",class:"form-label"},"*地址:",-1),ae={class:"modal-footer"},ce=Object(c["i"])("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"}," 取消 ",-1);function ne(e,t,a,n,r,i){return Object(c["w"])(),Object(c["e"])("div",f,[Object(c["i"])("div",h,[Object(c["i"])("div",g,[Object(c["i"])("div",v,[Object(c["i"])("h5",y,[Object(c["C"])(e.$slots,"title")]),k]),Object(c["i"])("div",M,[Object(c["i"])("div",_,[Object(c["i"])("div",w,[I,Object(c["i"])("p",x,Object(c["H"])(r.currentOrder.id),1)]),Object(c["i"])("div",C,[U,Object(c["R"])(Object(c["i"])("input",{type:"hidden",name:"create_at","onUpdate:modelValue":t[1]||(t[1]=function(e){return r.currentOrder.create_at=e})},null,512),[[c["M"],r.currentOrder.create_at]]),Object(c["i"])("p",P,Object(c["H"])(e.$filters.date(r.currentOrder.create_at)),1)]),Object(c["i"])("div",V,[$,Object(c["R"])(Object(c["i"])("select",{name:"is_paid",id:"is_paid",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.currentOrder.is_paid=e})},[D,S],512),[[c["L"],r.currentOrder.is_paid]])]),Object(c["i"])("div",H,[R,Object(c["R"])(Object(c["i"])("input",{type:"hidden",id:"total","onUpdate:modelValue":t[3]||(t[3]=function(e){return r.currentOrder.total=e})},null,512),[[c["M"],r.currentOrder.total,void 0,{number:!0}]]),Object(c["i"])("p",q,Object(c["H"])(e.$filters.currency(r.currentOrder.total)),1)]),Object(c["i"])("div",N,[B,Object(c["i"])("div",J,[(Object(c["w"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(r.currentOrder.products,(function(e){return Object(c["w"])(),Object(c["e"])(c["a"],{key:e.id},[Object(c["i"])("div",Q,[Object(c["R"])(Object(c["i"])("input",{type:"text",name:"title",disabled:"","onUpdate:modelValue":function(t){return e.product.title=t},class:"form-control"},null,8,["onUpdate:modelValue"]),[[c["M"],e.product.title]])]),Object(c["i"])("div",T,[Object(c["i"])("div",L,[Object(c["i"])("button",{type:"button",class:"btn btn-sm minus border border-2",onClick:function(t){e.qty=i.minusQuantity(e.qty),i.changeSum(e)}},[z],8,["onClick"]),Object(c["R"])(Object(c["i"])("input",{type:"number","onUpdate:modelValue":function(t){return e.qty=t},onChange:function(t){e.qty=i.verifyNumber(e.qty),i.changeSum(e)},class:"text-center form-control input-number h-100 rounded-0"},null,40,["onUpdate:modelValue","onChange"]),[[c["M"],e.qty,void 0,{number:!0}]]),Object(c["i"])("button",{type:"button",class:"btn btn-sm add border border-2",onClick:function(t){e.qty=i.addQuantity(e.qty),i.changeSum(e)}},[A],8,["onClick"])])]),Object(c["i"])("div",E,[Object(c["R"])(Object(c["i"])("input",{type:"text",disabled:"",name:"final_total","onUpdate:modelValue":function(t){return e.final_total=t},class:"form-control"},null,8,["onUpdate:modelValue"]),[[c["M"],e.final_total]])])],64)})),128))])]),F,Object(c["i"])("div",G,[K,Object(c["R"])(Object(c["i"])("input",{type:"text",name:"username",id:"username",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=function(e){return r.currentOrder.user.name=e})},null,512),[[c["M"],r.currentOrder.user.name]])]),Object(c["i"])("div",W,[X,Object(c["R"])(Object(c["i"])("input",{type:"text",name:"tel",id:"tel",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=function(e){return r.currentOrder.user.tel=e})},null,512),[[c["M"],r.currentOrder.user.tel]])]),Object(c["i"])("div",Y,[Z,Object(c["R"])(Object(c["i"])("input",{type:"email",name:"email",id:"email",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=function(e){return r.currentOrder.user.email=e})},null,512),[[c["M"],r.currentOrder.user.email]])]),Object(c["i"])("div",ee,[te,Object(c["R"])(Object(c["i"])("input",{type:"text",name:"address",id:"address",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=function(e){return r.currentOrder.user.address=e})},null,512),[[c["M"],r.currentOrder.user.address]])])])]),Object(c["i"])("div",ae,[ce,Object(c["i"])("button",{type:"button",class:"btn btn-primary btn-hv-style",onClick:t[8]||(t[8]=function(e){return i.updateOrder(r.currentOrder)})}," 儲存 ")])])])],512)}var re=a("5191"),ie=a("3be2"),le={name:"OrderMainModal",mixins:[re["a"]],props:{currentItem:{type:Object}},data:function(){return{currentOrder:{user:{},products:{}}}},watch:{currentItem:function(){this.currentOrder=this.currentItem}},methods:{addQuantity:ie["a"],minusQuantity:ie["e"],verifyNumber:ie["f"],changeSum:function(e){for(var t in e.final_total=e.qty*(e.coupon.percent/100)*e.total,this.currentOrder.total=0,this.currentOrder.products)this.currentOrder.total+=this.currentOrder.products[t].final_total},updateOrder:function(){this.$emit("updateOrder",this.currentOrder)}}};le.render=ne;var oe=le,se=a("feb1"),de={name:"OrderManage",components:{DeleteModal:j["a"],MainModal:oe,BackPagination:se["a"]},data:function(){return{orders:[],currentOrder:{},pageItem:{},modalTitle:""}},methods:{getOrders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/orders?page=").concat(e);t.emitter.emit("loading",!0),t.$http.get(a).then((function(e){e.data.success?(t.orders=JSON.parse(JSON.stringify(e.data.orders)),t.pageItem=Object(p["a"])({},e.data.pagination)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))},openModal:function(e){this.currentOrder=JSON.parse(JSON.stringify(e)),this.modalTitle="修改訂單",this.$refs.modalMain.showModal()},openDeleteModal:function(e){this.currentOrder=Object(p["a"])(Object(p["a"])({},e),{},{title:"訂單: ".concat(e.id)}),this.modalTitle="刪除訂單",this.$refs.modalDelete.showModal()},deleteOrder:function(e){var t=this,a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/order/").concat(e);t.emitter.emit("loading",!0),t.$refs.modalDelete.hideModal(),t.$http.delete(a).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:"訊息通知",content:"訂單更新成功",icon:"fas fa-check-circle"}),t.getOrders(t.pageItem.currentPage)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("loading",!1),t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"})}))},updateOrder:function(e){var t=this,a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/order/").concat(e.id);t.emitter.emit("loading",!0),t.$refs.modalMain.hideModal(),t.$http.put(a,{data:e}).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:"訊息通知",content:"訂單更新成功",icon:"fas fa-check-circle"}),t.getOrders(t.pageItem.currentPage)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message.join("、"),icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))}},created:function(){this.getOrders()}};de.render=O;t["default"]=de},feb1:function(e,t,a){"use strict";a("a9e3");var c=a("7a23"),n={"aria-label":"Page navigation"},r={class:"pagination justify-content-center"};function i(e,t,a,i,l,o){return Object(c["w"])(),Object(c["e"])("nav",n,[Object(c["i"])("ul",r,[Object(c["i"])("li",{class:["page-item",{disabled:!a.pageItem.has_pre}]},[Object(c["i"])("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=Object(c["S"])((function(e){return o.updatePage(Number(a.pageItem.current_page)-1)}),["prevent"]))},"«")],2),(Object(c["w"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(a.pageItem.total_pages,(function(e){return Object(c["w"])(),Object(c["e"])("li",{class:["page-item",{active:a.pageItem.current_page===e}],key:e},[Object(c["i"])("a",{class:"page-link",href:"#",onClick:Object(c["S"])((function(t){return o.updatePage(e)}),["prevent"])},Object(c["H"])(e),9,["onClick"])],2)})),128)),Object(c["i"])("li",{class:["page-item",{disabled:!a.pageItem.has_next}]},[Object(c["i"])("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=Object(c["S"])((function(e){return o.updatePage(Number(a.pageItem.current_page)+1)}),["prevent"]))},"»")],2)])])}var l={name:"BackPagination",props:["pageItem"],methods:{updatePage:function(e){this.$emit("updatePage",e)}}};l.render=i;t["a"]=l}}]);
//# sourceMappingURL=chunk-15e64c30.cd273288.js.map