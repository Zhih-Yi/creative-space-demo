(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-facccf72"],{2909:function(e,t,n){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function c(e){if(Array.isArray(e))return a(e)}n.d(t,"a",(function(){return r}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n("fb6a"),n("b0c0");function i(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e){return c(e)||o(e)||i(e)||l()}},cc91:function(e,t,n){"use strict";n.r(t);var a=n("7a23"),c={class:"container"},o={class:"row"},i=Object(a["i"])("div",{class:"col-12 py-5 text-center"},[Object(a["i"])("h1",null,"優惠卷管理")],-1),l={class:"col-12 text-end py-3"},r={class:"col-12"},u={class:"table-responsive"},s={key:0,class:"table",id:"table-product"},d=Object(a["i"])("thead",null,[Object(a["i"])("tr",null,[Object(a["i"])("th",null,"名稱"),Object(a["i"])("th",null,"優惠%"),Object(a["i"])("th",null,"是否啟用"),Object(a["i"])("th",null,"到期日"),Object(a["i"])("th",null,"編輯")])],-1),b={class:"col-12"};function p(e,t,n,p,m,f){var j=Object(a["D"])("BackPagination"),O=Object(a["D"])("MainModal"),h=Object(a["D"])("DeleteModal");return Object(a["w"])(),Object(a["e"])("div",c,[Object(a["i"])("div",o,[i,Object(a["i"])("div",l,[Object(a["i"])("button",{type:"button",class:"btn btn-primary btn-hv-style",onClick:t[1]||(t[1]=function(e){return f.openModal(!0)})}," 新增優惠卷 ")]),Object(a["i"])("div",r,[Object(a["i"])("div",u,[m.couponAll.length>0?(Object(a["w"])(),Object(a["e"])("table",s,[d,Object(a["i"])("tbody",null,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(m.couponAll,(function(t){return Object(a["w"])(),Object(a["e"])("tr",{key:t.id},[Object(a["i"])("td",null,Object(a["H"])(t.title),1),Object(a["i"])("td",null,Object(a["H"])(t.percent),1),Object(a["i"])("td",null,Object(a["H"])(t.is_enabled?"啟用":"未啟用"),1),Object(a["i"])("td",null,Object(a["H"])(e.$filters.date(t.due_date)),1),Object(a["i"])("td",null,[Object(a["i"])("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:function(e){return f.openModal(!1,t)}},"修改",8,["onClick"]),Object(a["i"])("button",{type:"button",class:"btn btn-outline-dark",onClick:function(e){return f.openDeleteModal(t)}},"刪除",8,["onClick"])])])})),128))])])):Object(a["f"])("",!0)])]),Object(a["i"])("div",b,[Object(a["i"])(j,{pageItem:m.pageItem,onUpdatePage:f.getCoupon},null,8,["pageItem","onUpdatePage"])])]),Object(a["i"])(O,{ref:"modalMain",currentItem:m.currentCoupon,onUpdateCoupon:f.updateCoupon},{title:Object(a["Q"])((function(){return[Object(a["h"])(Object(a["H"])(m.modalTitle),1)]})),_:1},8,["currentItem","onUpdateCoupon"]),Object(a["i"])(h,{ref:"modalDelete",currentItem:m.currentCoupon,onDeleteItem:f.deleteCoupon},{title:Object(a["Q"])((function(){return[Object(a["h"])(Object(a["H"])(m.modalTitle),1)]})),_:1},8,["currentItem","onDeleteItem"])])}var m=n("5530"),f=n("2909"),j=(n("99af"),n("a15b"),{class:"modal fade",ref:"modal",id:"couponModal",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true"}),O={class:"modal-dialog modal-xl"},h={class:"modal-content"},g={class:"modal-header bg-primary text-white"},v={class:"modal-title",id:"couponModalLabel"},y=Object(a["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),C={class:"modal-body"},M={class:"row"},k={class:"col-12"},w={class:"mb-3"},I=Object(a["i"])("label",{for:"title",class:"form-label"},"*名稱",-1),_={class:"mb-3"},x=Object(a["i"])("label",{for:"percent",class:"form-label"},"*優惠%",-1),A={class:"mb-3"},D=Object(a["i"])("label",{for:"code",class:"form-label"},"*優惠碼",-1),S={class:"mb-3"},$=Object(a["i"])("label",{for:"due_date",class:"form-label"},"*到期日",-1),P={class:"mb-3"},U={class:"form-check"},H=Object(a["i"])("label",{class:"form-check-label",for:"is_enabled"}," *是否啟用 ",-1),T={class:"modal-footer"},B=Object(a["i"])("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"},"取消",-1);function N(e,t,n,c,o,i){return Object(a["w"])(),Object(a["e"])("div",j,[Object(a["i"])("div",O,[Object(a["i"])("div",h,[Object(a["i"])("div",g,[Object(a["i"])("h5",v,[Object(a["C"])(e.$slots,"title")]),y]),Object(a["i"])("div",C,[Object(a["i"])("div",M,[Object(a["i"])("div",k,[Object(a["i"])("div",w,[I,Object(a["R"])(Object(a["i"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[1]||(t[1]=function(e){return o.currentCoupon.title=e}),placeholder:"請輸入名稱"},null,512),[[a["M"],o.currentCoupon.title]])]),Object(a["i"])("div",_,[x,Object(a["R"])(Object(a["i"])("input",{type:"text",class:"form-control",id:"percent","onUpdate:modelValue":t[2]||(t[2]=function(e){return o.currentCoupon.percent=e}),placeholder:"請輸入優惠%"},null,512),[[a["M"],o.currentCoupon.percent,void 0,{number:!0}]])]),Object(a["i"])("div",A,[D,Object(a["R"])(Object(a["i"])("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":t[3]||(t[3]=function(e){return o.currentCoupon.code=e}),placeholder:"請輸入優惠碼"},null,512),[[a["M"],o.currentCoupon.code]])]),Object(a["i"])("div",S,[$,Object(a["R"])(Object(a["i"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[4]||(t[4]=function(e){return o.currentCoupon.due_date=e}),placeholder:"請選擇到期日"},null,512),[[a["M"],o.currentCoupon.due_date]])]),Object(a["i"])("div",P,[Object(a["i"])("div",U,[Object(a["R"])(Object(a["i"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[5]||(t[5]=function(e){return o.currentCoupon.is_enabled=e})},null,512),[[a["K"],o.currentCoupon.is_enabled]]),H])])])])]),Object(a["i"])("div",T,[B,Object(a["i"])("button",{type:"button",class:"btn btn-primary btn-hv-style",onClick:t[6]||(t[6]=function(e){return i.updateCoupon(o.currentCoupon)})},"儲存")])])])],512)}var R=n("5191"),V={name:"CouponMainModal",mixins:[R["a"]],props:{currentItem:{type:Object,default:function(){return{}}}},data:function(){return{modal:{},currentCoupon:{}}},watch:{currentItem:function(){this.currentCoupon=this.currentItem}},methods:{updateCoupon:function(e){this.$emit("updateCoupon",e)}}};V.render=N;var J=V,L=n("d58b"),Q=n("feb1"),E={name:"CouponManage",components:{MainModal:J,DeleteModal:L["a"],BackPagination:Q["a"]},data:function(){return{couponAll:[],modalTitle:"",isNew:!0,currentCoupon:{},pageItem:{}}},methods:{getCoupon:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,n="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/coupons?page=").concat(e);t.emitter.emit("loading",!0),t.$http.get(n).then((function(e){e.data.success?(t.couponAll=Object(f["a"])(e.data.coupons),t.pageItem=Object(m["a"])({},e.data.pagination)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))},openModal:function(e,t){if(e)this.modalTitle="新增優惠卷",this.currentCoupon={},this.currentCoupon.is_enabled=0;else{this.modalTitle="修改優惠卷";var n=new Date(1e3*t.due_date),a=""+(n.getMonth()+1),c=""+n.getDate();a.length<2&&(a="0"+a),c.length<2&&(c="0"+c);var o="".concat(n.getFullYear(),"-").concat(a,"-").concat(c);this.currentCoupon=Object(m["a"])(Object(m["a"])({},t),{},{due_date:o})}this.isNew=e,this.$refs.modalMain.showModal()},openDeleteModal:function(e){this.modalTitle="刪除商品",this.currentCoupon=Object(m["a"])({},e),this.$refs.modalDelete.showModal()},updateCoupon:function(e){var t=this,n="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/coupon"),a="post";this.isNew||(n="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/coupon/").concat(e.id),a="put");var c=Object(m["a"])(Object(m["a"])({},e),{},{due_date:Math.floor(new Date(e.due_date)/1e3)});t.emitter.emit("loading",!0),t.$refs.modalMain.hideModal(),t.$http[a](n,{data:c}).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:"訊息通知",content:"優惠卷更新成功",icon:"fas fa-check-circle"}),t.getCoupon(t.pageItem.currentPage)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message.join("、"),icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))},deleteCoupon:function(e){var t=this,n="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/coupon/").concat(e);t.$http.delete(n).then((function(e){e.data.success?(t.$refs.modalDelete.hideModal(),t.emitter.emit("push-message",{style:"success",title:"訊息通知",content:"優惠卷刪除成功",icon:"fas fa-check-circle"}),t.getCoupon(t.pageItem.currentPage)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message,icon:"fas fa-exclamation-circle"})})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))}},created:function(){this.getCoupon()}};E.render=p;t["default"]=E},d28b:function(e,t,n){var a=n("746f");a("iterator")},e01a:function(e,t,n){"use strict";var a=n("23e7"),c=n("83ab"),o=n("da84"),i=n("5135"),l=n("861d"),r=n("9bf2").f,u=n("e893"),s=o.Symbol;if(c&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var d={},b=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof b?new s(e):void 0===e?s():s(e);return""===e&&(d[t]=!0),t};u(b,s);var p=b.prototype=s.prototype;p.constructor=b;var m=p.toString,f="Symbol(test)"==String(s("test")),j=/^Symbol\((.*)\)[^)]+$/;r(p,"description",{configurable:!0,get:function(){var e=l(this)?this.valueOf():this,t=m.call(e);if(i(d,e))return"";var n=f?t.slice(7,-1):t.replace(j,"$1");return""===n?void 0:n}}),a({global:!0,forced:!0},{Symbol:b})}},fb6a:function(e,t,n){"use strict";var a=n("23e7"),c=n("861d"),o=n("e8b5"),i=n("23cb"),l=n("50c4"),r=n("fc6a"),u=n("8418"),s=n("b622"),d=n("1dde"),b=d("slice"),p=s("species"),m=[].slice,f=Math.max;a({target:"Array",proto:!0,forced:!b},{slice:function(e,t){var n,a,s,d=r(this),b=l(d.length),j=i(e,b),O=i(void 0===t?b:t,b);if(o(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!o(n.prototype)?c(n)&&(n=n[p],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return m.call(d,j,O);for(a=new(void 0===n?Array:n)(f(O-j,0)),s=0;j<O;j++,s++)j in d&&u(a,s,d[j]);return a.length=s,a}})},feb1:function(e,t,n){"use strict";n("a9e3");var a=n("7a23"),c={"aria-label":"Page navigation"},o={class:"pagination justify-content-center"};function i(e,t,n,i,l,r){return Object(a["w"])(),Object(a["e"])("nav",c,[Object(a["i"])("ul",o,[Object(a["i"])("li",{class:["page-item",{disabled:!n.pageItem.has_pre}]},[Object(a["i"])("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=Object(a["S"])((function(e){return r.updatePage(Number(n.pageItem.current_page)-1)}),["prevent"]))},"«")],2),(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(n.pageItem.total_pages,(function(e){return Object(a["w"])(),Object(a["e"])("li",{class:["page-item",{active:n.pageItem.current_page===e}],key:e},[Object(a["i"])("a",{class:"page-link",href:"#",onClick:Object(a["S"])((function(t){return r.updatePage(e)}),["prevent"])},Object(a["H"])(e),9,["onClick"])],2)})),128)),Object(a["i"])("li",{class:["page-item",{disabled:!n.pageItem.has_next}]},[Object(a["i"])("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=Object(a["S"])((function(e){return r.updatePage(Number(n.pageItem.current_page)+1)}),["prevent"]))},"»")],2)])])}var l={name:"BackPagination",props:["pageItem"],methods:{updatePage:function(e){this.$emit("updatePage",e)}}};l.render=i;t["a"]=l}}]);
//# sourceMappingURL=chunk-facccf72.d1d15314.js.map