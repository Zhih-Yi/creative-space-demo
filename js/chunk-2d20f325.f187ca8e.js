(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20f325"],{b331:function(e,t,c){"use strict";c.r(t);c("b0c0");var a=c("7a23"),r={class:"container"},n={class:"row"},i=Object(a["i"])("div",{class:"col-12 py-5 text-center"},[Object(a["i"])("h1",null,"訂單管理")],-1),l={class:"col-12"},o={class:"table-responsive"},s={key:0,class:"table"},d=Object(a["i"])("thead",null,[Object(a["i"])("tr",null,[Object(a["i"])("th",null,"編號"),Object(a["i"])("th",null,"建立時間"),Object(a["i"])("th",null,"總金額"),Object(a["i"])("th",null,"客戶姓名"),Object(a["i"])("th",null,"是否付款"),Object(a["i"])("th",null,"編輯")])],-1),u={key:0,class:"text-success"},b={key:1},m={class:"col-12"};function O(e,t,c,O,j,p){var f=Object(a["D"])("BackPagination"),h=Object(a["D"])("MainModal"),g=Object(a["D"])("DeleteModal");return Object(a["w"])(),Object(a["e"])("div",r,[Object(a["i"])("div",n,[i,Object(a["i"])("div",l,[Object(a["i"])("div",o,[j.orders.length>0?(Object(a["w"])(),Object(a["e"])("table",s,[d,Object(a["i"])("tbody",null,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(j.orders,(function(t){return Object(a["w"])(),Object(a["e"])("tr",{key:t.id},[Object(a["i"])("td",null,Object(a["H"])(t.id),1),Object(a["i"])("td",null,Object(a["H"])(e.$filters.date(t.create_at)),1),Object(a["i"])("td",null,Object(a["H"])(t.total),1),Object(a["i"])("td",null,Object(a["H"])(t.user.name),1),Object(a["i"])("td",null,[t.is_paid?(Object(a["w"])(),Object(a["e"])("span",u,"已付款")):Object(a["f"])("",!0),t.is_paid?Object(a["f"])("",!0):(Object(a["w"])(),Object(a["e"])("span",b,"未付款"))]),Object(a["i"])("td",null,[Object(a["i"])("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:function(e){return p.openModal(t)}},"修改",8,["onClick"]),Object(a["i"])("button",{type:"button",class:"btn btn-outline-dark",onClick:function(e){return p.openDeleteModal(t)}},"刪除",8,["onClick"])])])})),128))])])):Object(a["f"])("",!0)])]),Object(a["i"])("div",m,[Object(a["i"])(f,{pageItem:j.pageItem,onUpdatePage:p.getOrders},null,8,["pageItem","onUpdatePage"])])]),Object(a["i"])(h,{ref:"modalMain",currentItem:j.currentOrder,onUpdateOrder:p.updateOrder},{title:Object(a["Q"])((function(){return[Object(a["h"])(Object(a["H"])(j.modalTitle),1)]})),_:1},8,["currentItem","onUpdateOrder"]),Object(a["i"])(g,{ref:"modalDelete",currentItem:j.currentOrder,onDeleteItem:p.deleteOrder},{title:Object(a["Q"])((function(){return[Object(a["h"])(Object(a["H"])(j.modalTitle),1)]})),_:1},8,["currentItem","onDeleteItem"])])}var j=c("5530"),p=(c("99af"),c("a15b"),c("d58b")),f={class:"modal fade",ref:"modal",id:"OrderModal",tabindex:"-1","aria-labelledby":"OrderModalLabel","aria-hidden":"true"},h={class:"modal-dialog modal-fullscreen"},g={class:"modal-content"},y={class:"modal-header bg-primary text-white"},v={class:"modal-title",id:"OrderModalLabel"},M=Object(a["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),k={class:"modal-body"},w={class:"row"},x={class:"mb-3 col-md-6"},_=Object(a["i"])("label",{class:"form-label"},"訂單編號",-1),U={class:"h5"},I={class:"mb-3 col-md-6"},C=Object(a["i"])("label",{for:"create_at",class:"form-label"},"建立時間",-1),V={class:"h5"},D={class:"mb-3 col-md-6"},$=Object(a["i"])("label",{for:"is_paid",class:"form-label"},"*付款狀態",-1),R=Object(a["i"])("option",{value:"true"},"已付款",-1),q=Object(a["i"])("option",{value:"false"},"未付款",-1),H={class:"mb-3 col-md-6"},S=Object(a["i"])("label",{for:"total",class:"form-label"},"*總金額",-1),J={class:"h5"},N={class:"my-3 col-12"},P=Object(a["i"])("label",{class:"form-label"},"*訂購商品",-1),Q={class:"bg-light row p-md-3"},T={class:"col-md-5 col-sm-6 mb-2 col-12"},B={class:"col-md-3 col-sm-3 mb-2 col-6"},L={class:"input-number-group input-group"},z=Object(a["i"])("i",{class:"bi bi-dash-lg"},null,-1),A=Object(a["i"])("i",{class:"bi bi-plus-lg"},null,-1),E={class:"col-md-4 col-sm-3 mb-2 col-6"},F=Object(a["i"])("div",{class:"col-12"},[Object(a["i"])("label",{class:"form-label"},"訂購者資料")],-1),G={class:"mb-3 col-md-6"},K=Object(a["i"])("label",{for:"username",class:"form-label"},"*姓名:",-1),W={class:"mb-3 col-md-6"},X=Object(a["i"])("label",{for:"tel",class:"form-label"},"*電話:",-1),Y={class:"mb-3 col-md-6"},Z=Object(a["i"])("label",{for:"email",class:"form-label"},"*email:",-1),ee={class:"mb-3 col-6"},te=Object(a["i"])("label",{for:"address",class:"form-label"},"*地址:",-1),ce={class:"modal-footer"},ae=Object(a["i"])("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"},"取消",-1);function re(e,t,c,r,n,i){return Object(a["w"])(),Object(a["e"])("div",f,[Object(a["i"])("div",h,[Object(a["i"])("div",g,[Object(a["i"])("div",y,[Object(a["i"])("h5",v,[Object(a["C"])(e.$slots,"title")]),M]),Object(a["i"])("div",k,[Object(a["i"])("div",w,[Object(a["i"])("div",x,[_,Object(a["i"])("p",U,Object(a["H"])(n.currentOrder.id),1)]),Object(a["i"])("div",I,[C,Object(a["R"])(Object(a["i"])("input",{type:"hidden",name:"create_at","onUpdate:modelValue":t[1]||(t[1]=function(e){return n.currentOrder.create_at=e})},null,512),[[a["M"],n.currentOrder.create_at]]),Object(a["i"])("p",V,Object(a["H"])(e.$filters.date(n.currentOrder.create_at)),1)]),Object(a["i"])("div",D,[$,Object(a["R"])(Object(a["i"])("select",{name:"is_paid",id:"is_paid",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=function(e){return n.currentOrder.is_paid=e})},[R,q],512),[[a["L"],n.currentOrder.is_paid]])]),Object(a["i"])("div",H,[S,Object(a["R"])(Object(a["i"])("input",{type:"hidden",id:"total","onUpdate:modelValue":t[3]||(t[3]=function(e){return n.currentOrder.total=e})},null,512),[[a["M"],n.currentOrder.total,void 0,{number:!0}]]),Object(a["i"])("p",J,Object(a["H"])(e.$filters.currency(n.currentOrder.total)),1)]),Object(a["i"])("div",N,[P,Object(a["i"])("div",Q,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(n.currentOrder.products,(function(e){return Object(a["w"])(),Object(a["e"])(a["a"],{key:e.id},[Object(a["i"])("div",T,[Object(a["R"])(Object(a["i"])("input",{type:"text",name:"title",disabled:"","onUpdate:modelValue":function(t){return e.product.title=t},class:"form-control"},null,8,["onUpdate:modelValue"]),[[a["M"],e.product.title]])]),Object(a["i"])("div",B,[Object(a["i"])("div",L,[Object(a["i"])("button",{type:"button",class:"btn btn-sm minus border border-2",onClick:function(t){e.qty=i.minusQuantity(e.qty),i.changeSum(e)}},[z],8,["onClick"]),Object(a["R"])(Object(a["i"])("input",{type:"number","onUpdate:modelValue":function(t){return e.qty=t},onChange:function(t){e.qty=i.verifyNumber(e.qty),i.changeSum(e)},class:"text-center form-control input-number h-100 rounded-0"},null,40,["onUpdate:modelValue","onChange"]),[[a["M"],e.qty,void 0,{number:!0}]]),Object(a["i"])("button",{type:"button",class:"btn btn-sm add border border-2",onClick:function(t){e.qty=i.addQuantity(e.qty),i.changeSum(e)}},[A],8,["onClick"])])]),Object(a["i"])("div",E,[Object(a["R"])(Object(a["i"])("input",{type:"text",disabled:"",name:"final_total","onUpdate:modelValue":function(t){return e.final_total=t},class:"form-control"},null,8,["onUpdate:modelValue"]),[[a["M"],e.final_total]])])],64)})),128))])]),F,Object(a["i"])("div",G,[K,Object(a["R"])(Object(a["i"])("input",{type:"text",name:"username",id:"username",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=function(e){return n.currentOrder.user.name=e})},null,512),[[a["M"],n.currentOrder.user.name]])]),Object(a["i"])("div",W,[X,Object(a["R"])(Object(a["i"])("input",{type:"text",name:"tel",id:"tel",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=function(e){return n.currentOrder.user.tel=e})},null,512),[[a["M"],n.currentOrder.user.tel]])]),Object(a["i"])("div",Y,[Z,Object(a["R"])(Object(a["i"])("input",{type:"email",name:"email",id:"email",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=function(e){return n.currentOrder.user.email=e})},null,512),[[a["M"],n.currentOrder.user.email]])]),Object(a["i"])("div",ee,[te,Object(a["R"])(Object(a["i"])("input",{type:"text",name:"address",id:"address",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=function(e){return n.currentOrder.user.address=e})},null,512),[[a["M"],n.currentOrder.user.address]])])])]),Object(a["i"])("div",ce,[ae,Object(a["i"])("button",{type:"button",class:"btn btn-primary btn-hv-style",onClick:t[8]||(t[8]=function(e){return i.updateOrder(n.currentOrder)})},"儲存")])])])],512)}var ne=c("5191"),ie=c("3be2"),le={name:"OrderMainModal",mixins:[ne["a"]],props:{currentItem:{type:Object}},data:function(){return{currentOrder:{user:{},products:{}}}},watch:{currentItem:function(){this.currentOrder=this.currentItem}},methods:{addQuantity:ie["a"],minusQuantity:ie["e"],verifyNumber:ie["f"],changeSum:function(e){for(var t in e.final_total=e.qty*(e.coupon.percent/100)*e.total,this.currentOrder.total=0,this.currentOrder.products)this.currentOrder.total+=this.currentOrder.products[t].final_total},updateOrder:function(){this.$emit("updateOrder",this.currentOrder)}}};le.render=re;var oe=le,se=c("feb1"),de={name:"OrderManage",components:{DeleteModal:p["a"],MainModal:oe,BackPagination:se["a"]},inject:["emitter"],data:function(){return{orders:[],currentOrder:{},pageItem:{},modalTitle:""}},methods:{getOrders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/orders?page=").concat(e);t.emitter.emit("loading",!0),t.$http.get(c).then((function(e){e.data.success?(t.orders=JSON.parse(JSON.stringify(e.data.orders)),t.pageItem=Object(j["a"])({},e.data.pagination)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))},openModal:function(e){this.currentOrder=JSON.parse(JSON.stringify(e)),this.modalTitle="修改訂單",this.$refs.modalMain.showModal()},openDeleteModal:function(e){this.currentOrder=Object(j["a"])(Object(j["a"])({},e),{},{title:"訂單: ".concat(e.id)}),this.modalTitle="刪除訂單",this.$refs.modalDelete.showModal()},deleteOrder:function(e){var t=this,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/order/").concat(e);t.emitter.emit("loading",!0),t.$refs.modalDelete.hideModal(),t.$http.delete(c).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:"訊息通知",content:"訂單更新成功",icon:"fas fa-check-circle"}),t.getOrders(t.pageItem.currentPage)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("loading",!1),t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"})}))},updateOrder:function(e){var t=this,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("creativespace","/admin/order/").concat(e.id);t.emitter.emit("loading",!0),t.$refs.modalMain.hideModal(),t.$http.put(c,{data:e}).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:"訊息通知",content:"訂單更新成功",icon:"fas fa-check-circle"}),t.getOrders(t.pageItem.currentPage)):t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e.data.message.join("、"),icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)})).catch((function(e){t.emitter.emit("push-message",{style:"danger",title:"錯誤通知",content:e,icon:"fas fa-exclamation-circle"}),t.emitter.emit("loading",!1)}))}},created:function(){this.getOrders()}};de.render=O;t["default"]=de}}]);
//# sourceMappingURL=chunk-2d20f325.f187ca8e.js.map